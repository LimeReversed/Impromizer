using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Headline_Randomizer
{
    public class AdjustText
    {
        // Method for sizing text automatically
        private float GetFontSize(TextBox label, string text, int margin, float min_size, float max_size)
        {
            // Only bother if there's text.
            if (text.Length == 0) return min_size;

            // See how much room we have, allowing a bit
            // for the Label's internal margin.
            int wid = label.Width - margin;
            int hgt = label.Height - margin;

            // Make a Graphics object to measure the text.
            using (Graphics gr = label.CreateGraphics())
            {
                while (max_size - min_size > 0.1f)
                {
                    float pt = (min_size + max_size) / 2f;
                    using (Font test_font =
                        new Font(label.Font.FontFamily, pt))
                    {
                        // See if this font is too big.
                        SizeF text_size =
                            gr.MeasureString(text, test_font);
                        if ((text_size.Width > wid) ||
                            (text_size.Height > hgt))
                            max_size = pt;
                        else
                            min_size = pt;
                    }
                }
                return min_size;
            }
        }

        public void AdjustSize(PresentationWindow form2)
        {
            if (form2.tbxResult.Text.Count() > 35)
            {
                int middleChar = form2.tbxResult.Text.Count() / 2;
                while (form2.tbxResult.Text[middleChar] != 32)
                {
                    middleChar = middleChar + 1;
                }
                form2.tbxResult.Text = form2.tbxResult.Text.Insert(middleChar + 1, "\r\n");

                form2.tbxResult.Location = new System.Drawing.Point(10, 8);
                form2.tbxResult.Font = new System.Drawing.Font("Adobe Fan Heiti Std", GetFontSize(form2.tbxResult, form2.tbxResult.Text, 3, 1f, 100f), System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            }
            else
            {
                form2.tbxResult.Font = new System.Drawing.Font("Adobe Fan Heiti Std", GetFontSize(form2.tbxResult, form2.tbxResult.Text, 3, 1f, 100f), System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
                form2.tbxResult.Location = new System.Drawing.Point(10, 25);
            }
        }
    }
}
